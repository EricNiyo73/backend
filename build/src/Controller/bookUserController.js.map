{"version":3,"file":"bookUserController.js","names":["_bookUserModel","_interopRequireDefault","require","_userModel","obj","__esModule","default","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","value","_toPropertyKey","configurable","writable","arg","_toPrimitive","String","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","Number","createbooking","req","user","User","findById","params","userId","status","json","message","date","body","time","existingBooking","book","findOne","availability","$elemMatch","$eq","bookingData","firstname","lastname","booking","save","err","console","error","exports","updatebook","next","updatedbook","findByIdAndUpdate","id","$set","new","deletebook","findByIdAndDelete","data","getbook","getbooks","books","find"],"sources":["../../../src/Controller/bookUserController.js"],"sourcesContent":["import book from \"../model/bookUserModel.js\";\r\nimport User from '../model/userModel.js'\r\n// ==================creation of availability book===========\r\n\r\nexport const createbooking = async (req, res) => {\r\n  try {\r\n    const user = await User.findById(req.params.userId);\r\n    if (!user){\r\n      return res.status(404).json({message: \"User not found\"});\r\n    }\r\n    const date = req.body.date; \r\n    const time = req.body.time;\r\n    const existingBooking = await book.findOne({\r\n      availability: {\r\n        $elemMatch: {\r\n          date: { $eq: date },\r\n          time: { $eq: time }\r\n        }\r\n      }\r\n      // 'availability.isAvailable': true,\r\n      // maxPeople: { $gte: capacity },\r\n    });\r\n\r\n    if (existingBooking) {\r\n      return res.status(401).json(\"No available booking for the specified date and time\");\r\n    } \r\n    else{\r\n    const bookingData = {\r\n      ...req.body,\r\n        firstname: user.firstname,\r\n        lastname: user.lastname\r\n      \r\n    };\r\n    // create a new booking\r\n    const booking = new book(bookingData);\r\n    // booking.roomUser = availableBooking._id;\r\n\r\n    await booking.save();\r\n\r\n    return res.status(200).json({\r\n      message: \"Booking request submitted successfully\",\r\n      booking,\r\n    });\r\n  }} catch (err) {\r\n    console.error(err);\r\n    return res.status(500).json(\"failed\");\r\n  }\r\n};\r\n\r\n// export const createbooking = async (req, res,date, time,capacity) => {\r\n//   try{\r\n//   book.findOne({ \r\n//     'availability.date': date, \r\n//     'availability.time': time, \r\n//     'availability.isAvailable': true},\r\n//      (err, bookuser) => {\r\n//     if (err) {\r\n//       return res.status(500).json(\"there is an error\");\r\n//     } else if (!bookuser) {\r\n//       return res.status(401).json(\"No available booking for the specified date and time\");\r\n//     } else {\r\n//       // create a new booking\r\n//       const booking = new book(req.body);\r\n\r\n//       booking.save((err,booking)=>{\r\n//         if(err){\r\n//           return res.status(500).json(\"failed\");\r\n//         }\r\n//         else {\r\n//           return res.status(200).json({\r\n//             message: \"success\",\r\n//             booking\r\n//           });\r\n//         }\r\n//       });\r\n//     }\r\n//   });\r\n//   } catch (err) {\r\n//     next(err);\r\n//   }\r\n  // const newbook = new book(req.body);\r\n\r\n  // try {\r\n  //   const savedbook = await newbook.save();\r\n  //   res.status(200).json(savedbook);\r\n  // } catch (err) {\r\n  //   next(err);\r\n  // }\r\n// };\r\n\r\n// ==================update book==========================\r\n\r\nexport const updatebook = async (req, res, next) => {\r\n    try {\r\n      const updatedbook = await book.findByIdAndUpdate(\r\n        req.params.id,\r\n        { $set: req.body },\r\n        { new: true }\r\n      );\r\n      res.status(200).json(updatedbook);\r\n    } catch (err) {\r\n      next(err);\r\n    }\r\n  };\r\n\r\n\r\n//   ==============================delete ==========================\r\n\r\nexport const deletebook = async (req, res) => {\r\n\r\n  try {\r\n    const booking = await book.findByIdAndDelete(req.params.id);\r\n    if (!booking) {\r\n      return res.status(404).json({\r\n        status: \"failed\",\r\n        message: \"booking not found\",\r\n      });\r\n    }\r\n    return res.status(204).json({\r\n      status: \"success\",\r\n      data: \"booking deleted successfuly\",\r\n    });\r\n  } catch (error) {\r\n    return res.status(400).json({ status: \"failed\", error });\r\n  }\r\n  };\r\n\r\n//   ==============================get one book================================\r\nexport const getbook = async (req, res, next) => {\r\n    try {\r\n      const getbook = await book.findById(req.params.id);\r\n      res.status(200).json(getbook);\r\n    } catch (err) {\r\n      next(err);\r\n    }\r\n  };\r\n//   ==========================get books availability==========================\r\nexport const getbooks = async (req, res, next) => {\r\n    try {\r\n      const books = await book.find();\r\n      res.status(200).json(books);\r\n    } catch (err) {\r\n      next(err);\r\n    }\r\n  };"],"mappings":";;;;;;AAAA,IAAAA,cAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,UAAA,GAAAF,sBAAA,CAAAC,OAAA;AAAwC,SAAAD,uBAAAG,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAAA,SAAAG,QAAAC,MAAA,EAAAC,cAAA,QAAAC,IAAA,GAAAC,MAAA,CAAAD,IAAA,CAAAF,MAAA,OAAAG,MAAA,CAAAC,qBAAA,QAAAC,OAAA,GAAAF,MAAA,CAAAC,qBAAA,CAAAJ,MAAA,GAAAC,cAAA,KAAAI,OAAA,GAAAA,OAAA,CAAAC,MAAA,WAAAC,GAAA,WAAAJ,MAAA,CAAAK,wBAAA,CAAAR,MAAA,EAAAO,GAAA,EAAAE,UAAA,OAAAP,IAAA,CAAAQ,IAAA,CAAAC,KAAA,CAAAT,IAAA,EAAAG,OAAA,YAAAH,IAAA;AAAA,SAAAU,cAAAC,MAAA,aAAAC,CAAA,MAAAA,CAAA,GAAAC,SAAA,CAAAC,MAAA,EAAAF,CAAA,UAAAG,MAAA,WAAAF,SAAA,CAAAD,CAAA,IAAAC,SAAA,CAAAD,CAAA,QAAAA,CAAA,OAAAf,OAAA,CAAAI,MAAA,CAAAc,MAAA,OAAAC,OAAA,WAAAC,GAAA,IAAAC,eAAA,CAAAP,MAAA,EAAAM,GAAA,EAAAF,MAAA,CAAAE,GAAA,SAAAhB,MAAA,CAAAkB,yBAAA,GAAAlB,MAAA,CAAAmB,gBAAA,CAAAT,MAAA,EAAAV,MAAA,CAAAkB,yBAAA,CAAAJ,MAAA,KAAAlB,OAAA,CAAAI,MAAA,CAAAc,MAAA,GAAAC,OAAA,WAAAC,GAAA,IAAAhB,MAAA,CAAAoB,cAAA,CAAAV,MAAA,EAAAM,GAAA,EAAAhB,MAAA,CAAAK,wBAAA,CAAAS,MAAA,EAAAE,GAAA,iBAAAN,MAAA;AAAA,SAAAO,gBAAAxB,GAAA,EAAAuB,GAAA,EAAAK,KAAA,IAAAL,GAAA,GAAAM,cAAA,CAAAN,GAAA,OAAAA,GAAA,IAAAvB,GAAA,IAAAO,MAAA,CAAAoB,cAAA,CAAA3B,GAAA,EAAAuB,GAAA,IAAAK,KAAA,EAAAA,KAAA,EAAAf,UAAA,QAAAiB,YAAA,QAAAC,QAAA,oBAAA/B,GAAA,CAAAuB,GAAA,IAAAK,KAAA,WAAA5B,GAAA;AAAA,SAAA6B,eAAAG,GAAA,QAAAT,GAAA,GAAAU,YAAA,CAAAD,GAAA,2BAAAT,GAAA,gBAAAA,GAAA,GAAAW,MAAA,CAAAX,GAAA;AAAA,SAAAU,aAAAE,KAAA,EAAAC,IAAA,eAAAD,KAAA,iBAAAA,KAAA,kBAAAA,KAAA,MAAAE,IAAA,GAAAF,KAAA,CAAAG,MAAA,CAAAC,WAAA,OAAAF,IAAA,KAAAG,SAAA,QAAAC,GAAA,GAAAJ,IAAA,CAAAK,IAAA,CAAAP,KAAA,EAAAC,IAAA,2BAAAK,GAAA,sBAAAA,GAAA,YAAAE,SAAA,4DAAAP,IAAA,gBAAAF,MAAA,GAAAU,MAAA,EAAAT,KAAA;AACxC;;AAEO,MAAMU,aAAa,GAAG,MAAAA,CAAOC,GAAG,EAAEL,GAAG,KAAK;EAC/C,IAAI;IACF,MAAMM,IAAI,GAAG,MAAMC,kBAAI,CAACC,QAAQ,CAACH,GAAG,CAACI,MAAM,CAACC,MAAM,CAAC;IACnD,IAAI,CAACJ,IAAI,EAAC;MACR,OAAON,GAAG,CAACW,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAACC,OAAO,EAAE;MAAgB,CAAC,CAAC;IAC1D;IACA,MAAMC,IAAI,GAAGT,GAAG,CAACU,IAAI,CAACD,IAAI;IAC1B,MAAME,IAAI,GAAGX,GAAG,CAACU,IAAI,CAACC,IAAI;IAC1B,MAAMC,eAAe,GAAG,MAAMC,sBAAI,CAACC,OAAO,CAAC;MACzCC,YAAY,EAAE;QACZC,UAAU,EAAE;UACVP,IAAI,EAAE;YAAEQ,GAAG,EAAER;UAAK,CAAC;UACnBE,IAAI,EAAE;YAAEM,GAAG,EAAEN;UAAK;QACpB;MACF;MACA;MACA;IACF,CAAC,CAAC;;IAEF,IAAIC,eAAe,EAAE;MACnB,OAAOjB,GAAG,CAACW,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,sDAAsD,CAAC;IACrF,CAAC,MACG;MACJ,MAAMW,WAAW,GAAAhD,aAAA,CAAAA,aAAA,KACZ8B,GAAG,CAACU,IAAI;QACTS,SAAS,EAAElB,IAAI,CAACkB,SAAS;QACzBC,QAAQ,EAAEnB,IAAI,CAACmB;MAAQ,EAE1B;MACD;MACA,MAAMC,OAAO,GAAG,IAAIR,sBAAI,CAACK,WAAW,CAAC;MACrC;;MAEA,MAAMG,OAAO,CAACC,IAAI,EAAE;MAEpB,OAAO3B,GAAG,CAACW,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAC1BC,OAAO,EAAE,wCAAwC;QACjDa;MACF,CAAC,CAAC;IACJ;EAAC,CAAC,CAAC,OAAOE,GAAG,EAAE;IACbC,OAAO,CAACC,KAAK,CAACF,GAAG,CAAC;IAClB,OAAO5B,GAAG,CAACW,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,QAAQ,CAAC;EACvC;AACF,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACF;;AAEA;AAAAmB,OAAA,CAAA3B,aAAA,GAAAA,aAAA;AAEO,MAAM4B,UAAU,GAAG,MAAAA,CAAO3B,GAAG,EAAEL,GAAG,EAAEiC,IAAI,KAAK;EAChD,IAAI;IACF,MAAMC,WAAW,GAAG,MAAMhB,sBAAI,CAACiB,iBAAiB,CAC9C9B,GAAG,CAACI,MAAM,CAAC2B,EAAE,EACb;MAAEC,IAAI,EAAEhC,GAAG,CAACU;IAAK,CAAC,EAClB;MAAEuB,GAAG,EAAE;IAAK,CAAC,CACd;IACDtC,GAAG,CAACW,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACsB,WAAW,CAAC;EACnC,CAAC,CAAC,OAAON,GAAG,EAAE;IACZK,IAAI,CAACL,GAAG,CAAC;EACX;AACF,CAAC;;AAGH;AAAAG,OAAA,CAAAC,UAAA,GAAAA,UAAA;AAEO,MAAMO,UAAU,GAAG,MAAAA,CAAOlC,GAAG,EAAEL,GAAG,KAAK;EAE5C,IAAI;IACF,MAAM0B,OAAO,GAAG,MAAMR,sBAAI,CAACsB,iBAAiB,CAACnC,GAAG,CAACI,MAAM,CAAC2B,EAAE,CAAC;IAC3D,IAAI,CAACV,OAAO,EAAE;MACZ,OAAO1B,GAAG,CAACW,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAC1BD,MAAM,EAAE,QAAQ;QAChBE,OAAO,EAAE;MACX,CAAC,CAAC;IACJ;IACA,OAAOb,GAAG,CAACW,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAC1BD,MAAM,EAAE,SAAS;MACjB8B,IAAI,EAAE;IACR,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOX,KAAK,EAAE;IACd,OAAO9B,GAAG,CAACW,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAED,MAAM,EAAE,QAAQ;MAAEmB;IAAM,CAAC,CAAC;EAC1D;AACA,CAAC;;AAEH;AAAAC,OAAA,CAAAQ,UAAA,GAAAA,UAAA;AACO,MAAMG,OAAO,GAAG,MAAAA,CAAOrC,GAAG,EAAEL,GAAG,EAAEiC,IAAI,KAAK;EAC7C,IAAI;IACF,MAAMS,OAAO,GAAG,MAAMxB,sBAAI,CAACV,QAAQ,CAACH,GAAG,CAACI,MAAM,CAAC2B,EAAE,CAAC;IAClDpC,GAAG,CAACW,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC8B,OAAO,CAAC;EAC/B,CAAC,CAAC,OAAOd,GAAG,EAAE;IACZK,IAAI,CAACL,GAAG,CAAC;EACX;AACF,CAAC;AACH;AAAAG,OAAA,CAAAW,OAAA,GAAAA,OAAA;AACO,MAAMC,QAAQ,GAAG,MAAAA,CAAOtC,GAAG,EAAEL,GAAG,EAAEiC,IAAI,KAAK;EAC9C,IAAI;IACF,MAAMW,KAAK,GAAG,MAAM1B,sBAAI,CAAC2B,IAAI,EAAE;IAC/B7C,GAAG,CAACW,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACgC,KAAK,CAAC;EAC7B,CAAC,CAAC,OAAOhB,GAAG,EAAE;IACZK,IAAI,CAACL,GAAG,CAAC;EACX;AACF,CAAC;AAACG,OAAA,CAAAY,QAAA,GAAAA,QAAA"}