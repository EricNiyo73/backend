{"version":3,"file":"bookUserController.js","names":["_bookUserModel","_interopRequireDefault","require","obj","__esModule","default","createbooking","req","res","date","time","capacity","book","findOne","err","bookuser","status","json","booking","body","save","message","next","exports","updatebook","updatedbook","findByIdAndUpdate","params","id","$set","new","updatebookAvailability","updateOne","$push","dates","deletebook","findByIdAndDelete","getbook","findById","getbooks","books","find"],"sources":["../../../src/Controller/bookUserController.js"],"sourcesContent":["import book from \"../model/bookUserModel.js\";\r\n\r\n// ==================creation of availability book===========\r\nexport const createbooking = async (req, res,date, time,capacity) => {\r\n  try{\r\n  book.findOne({ 'availability.date': date, 'availability.time': time, 'availability.isAvailable': true}, (err, bookuser) => {\r\n    if (err) {\r\n      return res.status(500).json(\"there is an error\");\r\n    } else if (!bookuser) {\r\n      return res.status(401).json(\"No available booking for the specified date and time\");\r\n    } else {\r\n      // create a new booking\r\n      const booking = new book(req.body);\r\n\r\n      booking.save();\r\n     return res.status(200).json({\r\n      message: \"success\",\r\n      booking\r\n    });\r\n    }\r\n  });\r\n  } catch (err) {\r\n    next(err);\r\n  }\r\n  // const newbook = new book(req.body);\r\n\r\n  // try {\r\n  //   const savedbook = await newbook.save();\r\n  //   res.status(200).json(savedbook);\r\n  // } catch (err) {\r\n  //   next(err);\r\n  // }\r\n};\r\n\r\n// ==================update book==========================\r\n\r\nexport const updatebook = async (req, res, next) => {\r\n    try {\r\n      const updatedbook = await book.findByIdAndUpdate(\r\n        req.params.id,\r\n        { $set: req.body },\r\n        { new: true }\r\n      );\r\n      res.status(200).json(updatedbook);\r\n    } catch (err) {\r\n      next(err);\r\n    }\r\n  };\r\n\r\n//   =======================update availability=========================\r\n\r\nexport const updatebookAvailability = async (req, res, next) => {\r\n    try {\r\n      await book.updateOne(\r\n        { \"bookNumbers._id\": req.params.id },\r\n        {\r\n          $push: {\r\n            \"bookNumbers.$.unavailableDates\": req.body.dates\r\n          },\r\n        }\r\n      );\r\n      res.status(200).json(\"book status has been updated.\");\r\n    } catch (err) {\r\n      next(err);\r\n    }\r\n  };\r\n\r\n//   ==============================delete ==========================\r\n\r\nexport const deletebook = async (req, res, next) => {\r\n    try {\r\n      await book.findByIdAndDelete(req.params.id);\r\n      res.status(200).json(\"book has been deleted.\");\r\n    } catch (err) {\r\n      next(err);\r\n    }\r\n  };\r\n\r\n//   ==============================get one book================================\r\nexport const getbook = async (req, res, next) => {\r\n    try {\r\n      const book = await book.findById(req.params.id);\r\n      res.status(200).json(book);\r\n    } catch (err) {\r\n      next(err);\r\n    }\r\n  };\r\n//   ==========================get books availability==========================\r\nexport const getbooks = async (req, res, next) => {\r\n    try {\r\n      const books = await book.find();\r\n      res.status(200).json(books);\r\n    } catch (err) {\r\n      next(err);\r\n    }\r\n  };"],"mappings":"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"}